
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10/dist/sweetalert2.min.css"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
  <link rel="stylesheet" href="/css/admin/user.css">

<div class="main-container">
  <!-- Page Header -->
  <div class="page-header">
    <h2 class="page-title">Users Management</h2>
  </div>

  <!-- Search Form -->
  <div class="search-container">
  <form action="/admin/users" method="get">
        <div class="flex justify-between items-center mb-4">
          <div class="flex w-1/2 relative">
            <input 
              class="bg-gray-800 text-white p-2 rounded-l w-full" 
              name="search" 
              value="<%= locals.search || '' %>" 
              placeholder="Search for User Name or Email" 
              type="text"
            />
            <button type="submit" class="bg-green-500 hover:bg-blue-600 text-white px-4 py-2 rounded-r">
              <i class="fas fa-search"></i>
              Search
            </button>
          </div>
          
          <% if (locals.search && locals.search.trim() !== '') { %>
            <a href="/admin/users" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded transition">
              <i class="fas fa-times mr-1"></i> Clear Results
            </a>
          <% } %>
        </div>
      </form>
</div>

  <!-- User Table -->
  <div class="table-container">
    <div class="table-wrapper">
      <table class="table users-table text-center">
        <thead>
          <tr>
            <th><i class="fas fa-user me-2"></i>Name</th>
            <th><i class="fas fa-envelope me-2"></i>Email</th>
            <th><i class="fas fa-phone me-2"></i>Phone No</th>
            <th><i class="fas fa-cogs me-2"></i>Action</th>
          </tr>
        </thead>
        <tbody>
         <% if (users && users.length > 0) { %>
  <% users.forEach(user => { %>
    <tr>
      <td><strong><%= user.name %></strong></td>
      <td><%= user.email %></td>
      <td><%= user.phone || '-' %></td>
      <td>
      
        <button 
  class="action-btn <%= user.isBlocked ? 'btn-unblock' : 'btn-block' %>"
  onclick="toggleBlock('<%= user._id %>', '<%= user.isBlocked %>', this)">
  <i class="fas <%= user.isBlocked ? 'fa-unlock' : 'fa-lock' %> me-1"></i>
  <%= user.isBlocked ? 'UnBlock' : 'Block' %>
</button>
      </td>
    </tr>
  <% }) %>
<% } else { %>
  <tr>
    <td colspan="4" class="no-data">
      <i class="fas fa-users fa-3x mb-3 text-muted"></i><br>
      No users found matching your search criteria
    </td>
  </tr>
<% } %>
</tbody>
</table>
</div>
</div>

  <!-- Pagination -->
 <div class="w-full flex justify-center mt-6">
  <div class="flex space-x-2">
    <% if (currentPage > 1) { %>
      <a href="?page=<%= currentPage - 1 %>" class="px-3 py-1 bg-gray-300 rounded hover:bg-gray-400 text-sm">
        &laquo; Prev
      </a>
    <% } %>

    <% for (let i = 1; i <= totalPages; i++) { %>
      <% if (i === currentPage) { %>
        <span class="px-3 py-1 bg-green-600 text-white rounded text-sm font-semibold"><%= i %></span>
      <% } else { %>
        <a href="?page=<%= i %>" class="px-3 py-1 bg-gray-300 rounded hover:bg-gray-400 text-sm"><%= i %></a>
      <% } %>
    <% } %>

    <% if (currentPage < totalPages) { %>
      <a href="?page=<%= currentPage + 1 %>" class="px-3 py-1 bg-gray-300 rounded hover:bg-gray-400 text-sm">
        Next &raquo;
      </a>
    <% } %>
  </div>
</div>

<script defer src="/js/admin/users.js"></script>