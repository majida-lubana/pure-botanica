<%- include("../../views/partials/user/header") %>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Email Verification</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  </head>
  <body class="bg-gray-100 flex items-center justify-center min-h-screen px-4">
    <div class="bg-white shadow-xl rounded-xl w-full max-w-md p-6">
      <h2 class="text-2xl font-bold text-center mb-6">Email Verification</h2>

      <form action="/forgotPass-otp" method="POST" class="space-y-4">
        <div>
          <label for="otp" class="block text-sm font-medium mb-1">Enter OTP:</label>
          <input
            type="text"
            id="otp"
            name="otp"
            required
            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
          />
        </div>

        <button
          type="submit"
          class="w-full bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 transition"
        >
          Verify OTP
        </button>
      </form>

      <!-- Timer -->
      <div class="flex justify-center mt-6">
        <div id="otpTimer" class="w-14 h-14 rounded-full bg-gray-200 flex items-center justify-center text-lg font-semibold text-gray-700">
          60
        </div>
      </div>

      <!-- Resend Button -->
      <div class="mt-4 text-center">
        <button
          type="button"
          onclick="resendOtp()"
          class="text-indigo-600 hover:underline text-sm"
        >
          Resend OTP
        </button>
      </div>

      <!-- Error Message -->
      <% if (typeof error !== 'undefined') { %>
        <div id="errorMessage" class="mt-4 text-sm text-red-600 text-center">
          <%= error %>
        </div>
      <% } else { %>
        <div id="errorMessage" class="hidden mt-4 text-sm text-red-600 text-center">
          Invalid OTP. Please try again.
        </div>
      <% } %>

      <!-- Login Link -->
      <div class="mt-6 text-center text-sm text-gray-600">
        Already verified?
        <a href="/login" class="text-indigo-600 hover:underline">Login now</a>
      </div>
    </div>

    <script>
      let timeLeft = 60;
      const timer = document.getElementById("otpTimer");

      const countdown = setInterval(() => {
        if (timeLeft <= 0) {
          clearInterval(countdown);
          timer.textContent = "00";
        } else {
          timer.textContent = timeLeft;
          timeLeft--;
        }
      }, 1000);

      function resendOtp() {
        Swal.fire("OTP Resent!", "Please check your email.", "success");
        timeLeft = 60;
      }
    </script>
  </body>
</html>
