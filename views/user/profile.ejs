<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/public/css/main.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/css/user/profile.css">
</head>

<body>
    <header class="header">
        <%- include('../partials/user/header') %>
    </header>
    <div class="container">
        <div class="sidebar">
            <%- include('../partials/user/sidebar') %>
        </div>
        <div class="content">
            <div class="tabs">
                <div class="tab active" data-tab="profile-details">Profile Details</div>
                <div class="tab" data-tab="change-password">Change Password</div>
            </div>

            <div id="profile-details" class="content-section active">
                <h2>Personal Information</h2>
                <div class="profile-view">
                    <div class="form-group">
                        <label>Full Name</label>
                        <p id="display-fullName"><%= user.name %></p>
                    </div>

                    <div class="form-group">
                        <label>Email Address</label>
                        <p id="display-email"><%= user.email %></p>
                    </div>

                    <div class="form-group">
                        <label>Phone Number</label>
                        <p id="display-phone"><%= user.phone %></p>
                    </div>

                    <div class="form-actions">
                        <button type="button" id="open-edit-profile-modal" class="btn btn-primary">Edit Profile</button>
                    </div>
                </div>
            </div>

            <div id="change-password" class="content-section">
                <h2>Change Password</h2>
                <form id="change-password-form" action="/change-password" method="POST">
                    <div class="form-group">
                        <label for="current-password">Current Password</label>
                        <input type="password" id="current-password" name="current-password">
                        <i class="fas fa-eye password-visibility"
                            onclick="togglePasswordVisibility(this, 'current-password')"></i>
                        <div id="current-password-error" class="error-message"></div>
                    </div>

                    <div class="form-group">
                        <label for="new-password">New Password</label>
                        <input type="password" id="new-password" name="new-password">
                        <i class="fas fa-eye password-visibility"
                            onclick="togglePasswordVisibility(this, 'new-password')"></i>
                        <div id="new-password-error" class="error-message"></div>
                    </div>

                    <div class="form-group">
                        <label for="confirm-password">Confirm New Password</label>
                        <input type="password" id="confirm-password" name="confirm-password">
                        <i class="fas fa-eye password-visibility"
                            onclick="togglePasswordVisibility(this, 'confirm-password')"></i>
                        <div id="confirm-password-error" class="error-message"></div>
                    </div>

                    <div id="password-change-success" class="success-message">
                        Password changed successfully!
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Update Password</button>
                        <button type="button" class="btn btn-secondary">Cancel</button>
                    </div>

                    <div class="security-tips">
                        <h3>Security Tips</h3>
                        <ul>
                            <li>Use a unique password for each account</li>
                            <li>Consider using a password manager</li>
                            <li>Change your password every 3-6 months</li>
                            <li>Don't share your password with others</li>
                        </ul>

                        <h3>Password Requirements:</h3>
                        <ul>
                            <li>Minimum 8 characters long</li>
                            <li>Include at least one uppercase letter</li>
                            <li>Include at least one lowercase letter</li>
                            <li>Include at least one number</li>
                            <li>Include at least one special character</li>
                        </ul>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="email-change-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <div class="modal-header">
                <h3>Change Email</h3>
            </div>

            <div id="email-input-section">
                <div class="form-group">
                    <label for="new-email">New Email Address</label>
                    <input type="email" id="new-email" name="new-email">
                    <div id="new-email-error" class="error-message"></div>
                </div>
                <button id="send-otp-btn" class="btn btn-primary">Send OTP</button>
            </div>

            <div id="otp-section" style="display: none;">
                <div class="form-group">
                    <label for="otp-input">Enter OTP</label>
                    <input type="text" id="otp-input" name="otp-input" maxlength="4">
                    <div id="otp-error" class="error-message"></div>
                </div>
                <div class="form-actions">
                    <button id="verify-otp-btn" class="btn btn-primary">Verify OTP</button>
                    <button id="resend-otp-btn" class="btn btn-secondary">Resend OTP</button>
                </div>
            </div>

            <div id="success-section" style="display: none;">
                <div class="success-icon"><i class="fas fa-check-circle"></i></div>
                <div class="success-message">Email changed successfully!</div>
                <button class="btn btn-primary"id="doneBtn" onclick="closeModal()">Done</button>
            </div>
        </div>
    </div>

    <div id="edit-profile-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3>Edit Profile</h3>

            <form id="edit-profile-modal-form">
                <div class="form-group">
                    <label for="modal-fullName">Full Name</label>
                    <input type="text" id="modal-fullName" name="name">
                    <div id="modal-name-error" class="error-message"></div>
                </div>

                <div class="form-group">
                    <label for="modal-phone">Phone Number</label>
                    <input type="tel" id="modal-phone" name="phone">
                    <div id="modal-phone-error" class="error-message"></div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                    <button type="button" class="btn btn-secondary" id="cancel-edit-profile">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <%- include('../partials/user/footer') %>
    <script defer src="/js/user/profile.js"></script>
   
</body>

</html>