<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Reset Password</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
  </head>
  <body class="min-h-screen flex items-center justify-center p-6 relative">
    <img
      alt="Blurred cosmetic product bottles with white flowers in foreground"
      class="absolute inset-0 w-full h-full object-cover"
      src="https://storage.googleapis.com/a1aa/image/aff8b111-8925-4b75-503a-b5fdc7cbeab9.jpg"
    />
    <div class="relative w-full max-w-lg bg-white bg-opacity-90 rounded-xl p-6 shadow-md">
      <h2 class="text-xl font-bold text-center mb-4 text-gray-800 font-sans">Reset Password</h2>

      <form action="/reset-password" method="POST" class="space-y-4" onsubmit="return validatePassword()">
        <div class="mb-3">
          <label for="password" class="block text-sm font-medium mb-1 text-gray-700 font-sans">New Password</label>
          <div class="relative">
            <input
              type="password"
              id="password"
              name="password"
              required
              class="w-full bg-gray-50 border border-gray-200 text-sm text-gray-600 rounded-sm px-3 py-1.5 focus:outline-none focus:ring-1 focus:ring-black transition duration-200"
              placeholder="Enter new password"
            />
            <i class="fas fa-eye absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 cursor-pointer" onclick="togglePassword('password', this)"></i>
          </div>
        </div>
        <div class="mb-3">
          <label for="confirmPassword" class="block text-sm font-medium mb-1 text-gray-700 font-sans">Confirm Password</label>
          <div class="relative">
            <input
              type="password"
              id="confirmPassword"
              name="confirmPassword"
              required
              class="w-full bg-gray-50 border border-gray-200 text-sm text-gray-600 rounded-sm px-3 py-1.5 focus:outline-none focus:ring-1 focus:ring-black transition duration-200"
              placeholder="Confirm new password"
            />
            <i class="fas fa-eye absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 cursor-pointer" onclick="togglePassword('confirmPassword', this)"></i>
          </div>
        </div>

        <div class="flex space-x-2">
          <button
            type="button"
            onclick="window.location.href='/login'"
            class="flex-1 bg-gray-300 text-gray-600 text-sm px-4 py-1.5 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 transition duration-200 font-sans"
          >
            Cancel
          </button>
          <button
            type="submit"
            class="flex-1 bg-black text-white text-sm px-4 py-1.5 rounded-md hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-black transition duration-200 font-sans"
          >
            Submit
          </button>
        </div>
      </form>

      <div class="flex items-center my-3 text-xs text-gray-500">
        <div class="flex-grow border-t border-gray-300"></div>
        <span class="mx-2 whitespace-nowrap">or sign in with</span>
        <div class="flex-grow border-t border-gray-300"></div>
      </div>
      <div class="flex space-x-2 text-[9px]">
        <a href="/auth/google" class="flex-1 border border-gray-300 rounded-sm py-0.5 text-gray-600 hover:bg-gray-100 text-center block">
          <i class="fab fa-google mr-1"></i>Login With Google
        </a>
        <button class="flex-1 border border-gray-300 rounded-sm py-0.5 text-gray-600 hover:bg-gray-100" type="button">
          <i class="fab fa-facebook-f mr-1"></i>Login With Facebook
        </button>
      </div>

      <% if (error) { %>
        <div id="errorMessage" class="mt-3 text-xs text-red-600 text-center font-sans">
          <%= error %>
        </div>
      <% } else { %>
        <div id="errorMessage" class="hidden mt-3 text-xs text-red-600 text-center font-sans"></div>
      <% } %>

      <div class="mt-4 text-center text-sm text-gray-600 font-sans">
        Back to login?
        <a href="/login" class="text-indigo-600 hover:underline">Login now</a>
      </div>
    </div>

    <script>
      function validatePassword() {
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        const errorMessage = document.getElementById('errorMessage');
        const passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;

        errorMessage.classList.add('hidden');

        if (password !== confirmPassword) {
          errorMessage.textContent = 'Passwords do not match.';
          errorMessage.classList.remove('hidden');
          return false;
        }

        if (password.length < 8) {
          errorMessage.textContent = 'Password must be at least 8 characters long.';
          errorMessage.classList.remove('hidden');
          return false;
        }

        if (!passwordPattern.test(password)) {
          errorMessage.textContent = 'Password must include uppercase, lowercase, number, and special character.';
          errorMessage.classList.remove('hidden');
          return false;
        }

        return true;
      }

      function togglePassword(inputId, icon) {
        const input = document.getElementById(inputId);
        if (input.type === 'password') {
          input.type = 'text';
          icon.classList.remove('fa-eye');
          icon.classList.add('fa-eye-slash');
        } else {
          input.type = 'password';
          icon.classList.remove('fa-eye-slash');
          icon.classList.add('fa-eye');
        }
      }
    </script>
  </body>
</html>